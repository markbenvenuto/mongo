<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"  xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
    <Fragment>
        <UI Id="MongoWixUI">
            <!-- Base our MSI on the FeatureTree based Wix set, and add our custom dialog boxes -->
            <UIRef Id="WixUI_FeatureTree" />

            <Publish Event="NewDialog" Value="MongoSetupTypeDlg" Dialog="LicenseAgreementDlg" Control="Next">LicenseAccepted = "1"</Publish>
            <!--<Publish Event="NewDialog" Value="MongoSetupTypeDlg" Dialog="Dialog1" Control="Back">WixUI_InstallMode = "InstallTypical" OR WixUI_InstallMode = "InstallComplete"</Publish>-->
            <Publish Event="NewDialog" Value="MongoSetupTypeDlg" Dialog="CustomizeDlg" Control="Back">WixUI_InstallMode = "InstallCustom"</Publish>

            <!-- A custom setup type dialog box with only Complete and Custom buttons -->
            <Dialog Id="MongoSetupTypeDlg" X="50" Y="50" Width="370" Height="270" Title="[ProductName] Setup">
                <Control Id="CompleteButton" Type="PushButton" X="40" Y="65" Width="80" Height="17" Text="C&amp;omplete" ToolTip="Complete Installation" TabSkip="no" Default="yes">
                    <Publish Property="WixUI_InstallMode" Value="InstallComplete">1</Publish>
                    <Publish Event="NewDialog" Value="Dialog1">1</Publish>
                    <Publish Event="SetInstallLevel" Value="1000">1</Publish>
                </Control>
                <Control Id="CustomButton" Type="PushButton" X="40" Y="118" Width="80" Height="17" Text="C&amp;ustom" ToolTip="Custom Installation" TabSkip="no">
                    <Publish Property="WixUI_InstallMode" Value="InstallCustom">1</Publish>
                    <Publish Event="NewDialog" Value="CustomizeDlg">1</Publish>
                </Control>
                <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="&amp;Back" TabSkip="no">
                    <Publish Event="NewDialog" Value="LicenseAgreementDlg">1</Publish>
                </Control>
                <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Text="&amp;Next" TabSkip="no" Disabled="yes" />
                <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Text="Cancel" TabSkip="no" Cancel="yes">
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" Text="WixUI_Bmp_Banner" TabSkip="no" Disabled="yes" />
                <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Text="Choose the setup type that best suits your needs" TabSkip="yes" Transparent="yes" NoPrefix="yes" />
                <Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Text="{\WixUI_Font_Title}Choose Setup Type" TabSkip="yes" Transparent="yes" NoPrefix="yes" />
                <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" TabSkip="yes" Disabled="yes" />
                <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" TabSkip="yes" Disabled="yes" />
                <Control Id="TypicalText" Type="Text" X="60" Y="85" Width="280" Height="20" Text="All program features will be installed. Requires the most disk space. Recommended for most users." TabSkip="yes" />
                <Control Id="CustomText" Type="Text" X="60" Y="138" Width="280" Height="30" Text="Allows users to choose which program features will be installed and where they will be installed. Recommended for advanced users." TabSkip="yes" />
            </Dialog>

            <Publish Event="NewDialog" Value="Dialog1" Dialog="VerifyReadyDlg" Control="Back">WixUI_InstallMode = "InstallTypical" OR WixUI_InstallMode = "InstallComplete"</Publish>
            <!--<Publish Event="NewDialog" Value="Dialog1" Dialog="CustomizeDlg" Control="Back">WixUI_InstallMode = "InstallCustom"</Publish>-->

            <Dialog Id="Dialog1" X="50" Y="50" Width="375" Height="270" Title="[ProductName] Service Customization">
                <Control Id="textTitle" Type="Text" X="8" Y="8" Width="122" Height="15" TabSkip="yes" Transparent="yes">
                    <Text>{\WixUI_Font_Title}Service Configuration</Text>
                </Control>
                <Control Id="textDescription" Type="Text" X="23" Y="23" Width="345" Height="10" TabSkip="yes" Transparent="yes">
                    <Text>Specify optional settings to configiure MongoDB as a service.</Text>
                </Control>
                <Control Id="lineTopDivider" Type="Line" X="0" Y="44" Width="375" Height="2" />
                <Control Id="lineBottomDivider" Type="Line" X="0" Y="234" Width="375" Height="2" />
                <Control Id="Back" Type="PushButton" X="189" Y="244" Width="56" Height="17" TabSkip="no">
                    <Text>&lt; &amp;Back</Text>
                    <Publish Event="NewDialog" Value="MongoSetupTypeDlg" Order="1">WixUI_InstallMode = "InstallTypical" OR WixUI_InstallMode = "InstallComplete"</Publish>
                    <Publish Event="NewDialog" Value="CustomizeDlg" Order="2">WixUI_InstallMode = "InstallCustom"</Publish>
                </Control>
                <Control Id="Next" Type="PushButton" X="244" Y="244" Width="56" Height="17" TabSkip="no">
                    <Text>&amp;Next &gt;</Text>
                    <Publish Event="AddLocal" Value="ServerNoService">NOT MONGO_SERVICE_INSTALL</Publish>
                    <Publish Event="AddLocal" Value="ServerService">MONGO_SERVICE_INSTALL</Publish>
                    <Publish Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
                </Control>
                <Control Id="Cancel" Type="PushButton" X="309" Y="244" Width="56" Height="17" TabSkip="no">
                    <Text>Cancel</Text>
                    <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
                </Control>
                <Control Id="CheckBox1" Type="CheckBox" X="8" Y="48" Width="132" Height="18"  Property="MONGO_SERVICE_INSTALL" CheckBoxValue="TRUE" TabSkip="no">
                    <Text>Install MongoD as a Service</Text>
                </Control>
                <Control Id="RadioButtonGroup1" Type="RadioButtonGroup" Property="MONGO_SERVICE_ACCOUNT_TYPE" X="20" Y="62" Width="180" Height="44">
                    <RadioButtonGroup Property="MONGO_SERVICE_ACCOUNT_TYPE">
                        <RadioButton X="0" Y="2" Width="184" Height="18" Value="ServiceLocalNetwork" Text="Run service as Network Service user" />
                        <RadioButton X="0" Y="18" Width="184" Height="18" Value="ServiceCustomAccount" Text="Run service as a local or domain user:" />
                    </RadioButtonGroup>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="Text7" Type="Text" X="38" Y="100" Width="76" Height="16" TabSkip="yes">
                    <Text>Account Name:</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL OR MONGO_SERVICE_ACCOUNT_TYPE = "ServiceLocalNetwork"</Condition>
                    <Condition Action="enable"><![CDATA[MONGO_SERVICE_INSTALL AND MONGO_SERVICE_ACCOUNT_TYPE <> "ServiceLocalNetwork"]]></Condition>
                </Control>
                <Control Id="Text8" Type="Text" X="38" Y="118" Width="76" Height="16" TabSkip="yes">
                    <Text>Account Password:</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL OR MONGO_SERVICE_ACCOUNT_TYPE = "ServiceLocalNetwork"</Condition>
                    <Condition Action="enable"><![CDATA[MONGO_SERVICE_INSTALL AND MONGO_SERVICE_ACCOUNT_TYPE <> "ServiceLocalNetwork"]]></Condition>
                </Control>
                <Control Id="Edit9" Type="Edit" X="126" Y="100" Width="100" Height="15" TabSkip="no" Property="MONGO_SERVICE_ACCOUNT_NAME">
                    <Text>{32767}</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL OR MONGO_SERVICE_ACCOUNT_TYPE = "ServiceLocalNetwork"</Condition>
                    <Condition Action="enable"><![CDATA[MONGO_SERVICE_INSTALL AND MONGO_SERVICE_ACCOUNT_TYPE <> "ServiceLocalNetwork"]]></Condition>
                </Control>
                <Control Id="Edit10" Type="Edit" X="126" Y="118" Width="100" Height="15" TabSkip="no" Password="yes" Property="MONGO_SERVICE_ACCOUNT_PASSWORD">
                    <Text>{32767}</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL OR MONGO_SERVICE_ACCOUNT_TYPE = "ServiceLocalNetwork"</Condition>
                    <Condition Action="enable"><![CDATA[MONGO_SERVICE_INSTALL AND MONGO_SERVICE_ACCOUNT_TYPE <> "ServiceLocalNetwork"]]></Condition>
                </Control>
                <Control Id="Text11" Type="Text" X="20" Y="140" Width="62" Height="15" TabSkip="yes">
                    <Text>Service Name:</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="Edit12" Type="Edit" X="96" Y="140" Width="105" Height="15" TabSkip="no" Property="MONGO_SERVICE_NAME">
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="Text13" Type="Text" X="20" Y="165" Width="61" Height="15" TabSkip="yes">
                    <Text>Data Directory:</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="Text14" Type="Text" X="20" Y="184" Width="61" Height="15" TabSkip="yes">
                    <Text>Log Directory:</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="Edit15" Type="Edit" X="96" Y="165" Width="238" Height="15" TabSkip="no" Property="MONGO_DATA_PATH">
                    <Text>{32767}</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="Edit16" Type="Edit" X="96" Y="184" Width="238" Height="15" TabSkip="no" Property="MONGO_LOG_PATH">
                    <Text>{32767}</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
                <Control Id="CheckBox18" Type="CheckBox" X="20" Y="215" Width="218" Height="16" Property="MONGO_SERVICE_FIREWALL_EXCEPTION" CheckBoxValue="1" TabSkip="no">
                    <Text>Add exception for MongoDB to Windows Firewall</Text>
                    <Condition Action="disable">NOT MONGO_SERVICE_INSTALL</Condition>
                    <Condition Action="enable">MONGO_SERVICE_INSTALL</Condition>
                </Control>
        </Dialog>


        </UI>
    </Fragment>
</Wix>

